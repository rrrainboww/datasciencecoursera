# Yifang Chen, Xiaowen Yang
# CSE 160
# Mar 6th 2016
# Final Project

import matplotlib.pyplot as plt
import csv
from operator import itemgetter

class Job:
    
    def __init__(self, keyword):
        self.key = keyword
        self.input_dict = csv.DictReader(open("ScriptData.csv"))
        self.keywords = []
        
        for items in self.input_dict:
            if items["KEYWORD_IN"] == keyword:
                self.keywords.append(items)

    def group(self, requirement):
        result = []
        for items in self.keywords:
            result.append(items[requirement])
        return result
          
    def plot_location(self, location_list):
        location_rank_list = self.rank_location(location_list)
        print location_rank_list
        x = [i for i in range(len(location_rank_list))]
        x_value = [name[0] for name in location_rank_list]
        y_value = [name[1] for name in location_rank_list]
        plt.xticks(x, x_value)
        plt.plot(x, y_value)
        plt.legend([self.key])
        plt.xlabel('State')
        plt.ylabel('Frequency')
        plt.savefig(self.key + 'location_rank.png')
        plt.show()
        
    
    def rank_location(self, location_list):
        state_frequency = {}
        for location in location_list:
            location = location.split(',')
            state_frequency.setdefault(location[len(location) - 1], 0)
            state_frequency[location[len(location) - 1]] += 1
        sorted_by_frequency = sorted(state_frequency.items(), key = itemgetter(1), reverse = True)
        return sorted_by_frequency
        
job = Job('BIG DATA')
#print job.keywords
groups = job.group('LOCATION')
job.plot_location(groups)
